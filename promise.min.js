/*! jstool-promise 2015-01-29 */
!function(a){"undefined"==typeof window?"undefined"!=typeof module&&(module.exports=a()):window.fn?fn.define("qPromise",a):window.qPromise||(window.qPromise=a())}(function(){function a(){this["[[PromiseStatus]]"]="pending",this["[[PromiseValue]]"]=void 0}function b(a,b){b instanceof Function&&setTimeout(function(){b.apply(a,[function(b){a.resolve(b)},function(b){a.reject(b)}])},0)}function c(a,b){for(var c=a.shift();a.length&&!c[b];)c=a.shift();return c}function d(a,b,d,e){var f=c(a.queue,d);if(f?(a["[[PromiseStatus]]"]=b,void 0!==e&&(a["[[PromiseValue]]"]=e)):(f=c(a.queue.finally,d),e=a["[[PromiseValue]]"]),f&&f[d]){var g=f[d].call(a,e);switch(a["[[PromiseStatus]]"]){case"fulfilled":a.resolve(void 0===g?e:g);break;case"rejected":a.reject(void 0===g?e:g)}}return a}function e(a){this.queue=[],this.queue.finally=[],b(this,a)}return e.prototype=new a,e.prototype.then=function(a,b){return a instanceof Function&&this.queue.push({then:a,"catch":b}),this},e.prototype.catch=function(a){return a instanceof Function&&this.queue.push({"catch":a}),this},e.prototype.finally=function(a,b){return a instanceof Function&&this.queue.finally.push({then:a,"catch":b}),this},e.prototype.resolve=function(a){return d(this,"fulfilled","then",a)},e.prototype.reject=function(a){return d(this,"rejected","catch",a)},e.prototype.hold=function(a){this["[[PromiseStatus]]"]="pending",this["[[PromiseValue]]"]=void 0,b(this,a)},e.defer=function(){return new e},e});